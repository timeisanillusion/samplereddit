<!DOCTYPE html>
<html>
<head>
    <title>Reddit Word Cloud</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.0.6/wordcloud2.min.js"></script>
</head>
<body>
    <h1>Reddit Word Cloud</h1>

    <div id="wordCloud">
        <!-- Word cloud will be displayed here -->
    </div>

    <script>
        window.onload = function() {
            console.log("Page loaded.");

            function fetchAndUpdateWordCloud() {
                console.log("Fetching data from Reddit...");
                const subredditName = "geegees"; // Replace with your subreddit name
                const apiUrl = `https://www.reddit.com/r/${subredditName}.json`;

                fetch(apiUrl)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`Failed to fetch data from Reddit. Status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log("Data from Reddit fetched successfully:", data);
                        const textData = data.data.children.map(child => child.data.title).join(' ');
                        generateWordCloud(textData);
                    })
                    .catch(error => {
                        console.error("Error fetching data from Reddit:", error);
                    });
            }

            function generateWordCloud(textData) {
                console.log("Generating word cloud...");
                WordCloud(document.getElementById('wordCloud'), {
                    list: textData.split(' '),
                    gridSize: 10,
                    weightFactor: 5,
                    fontFamily: 'Arial',
                    color: 'random-light',
                    backgroundColor: 'black',
                    rotateRatio: 0.2,
                    shuffle: true
                });
            }

            // Fetch and update the word cloud every 5 minutes (adjust the interval as needed)
            setInterval(fetchAndUpdateWordCloud, 300000);

            // Initial fetch and update when the page loads
            fetchAndUpdateWordCloud();
        };
    </script>
</body>
</html>
